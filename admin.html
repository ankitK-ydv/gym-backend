<!DOCTYPE html>
<html>
<head>
 

  <title>BeastFit Admin Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-light p-4">

  <a href="/logout" class="btn btn-sm btn-danger mb-3">Logout</a>


<h2 class="mb-4">ğŸ“‹ BeastFit â€“ Form Submissions</h2>

<div class="mb-3">
  <button class="btn btn-danger btn-sm me-2" onclick="deleteSelected()">
    ğŸ—‘ Delete Selected
  </button>
  <button class="btn btn-outline-danger btn-sm" onclick="deleteAll()">
    âŒ Delete All
  </button>

  <button class="btn btn-success btn-sm me-2" onclick="exportExcel()">
  ğŸ“¥ Export to Excel
</button>

</div>

<table class="table table-dark table-bordered align-middle">
  <thead>
    <tr>
      <th>
        <input type="checkbox" id="selectAll" onclick="toggleAll(this)">
      </th>
      <th>Name</th>
      <th>Phone</th>
      <th>Plan</th>
      <th>Goal</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>


<script>
fetch("/admin/data")
  .then(res => res.json())
  .then(data => {
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    data.forEach((item, index) => {
      tbody.innerHTML += `
        <tr>
          <td>
            <input type="checkbox" class="rowCheck" value="${index}">
          </td>
          <td>${item.fullName}</td>
          <td>${item.phone}</td>
          <td>${item.plan}</td>
          <td>${item.goal || "-"}</td>
          <td>${item.date}</td>
        </tr>
      `;
    });
  });
</script>

  <!-- BELETE FUNCTION -->

<script>
function toggleAll(source) {
  document.querySelectorAll(".rowCheck").forEach(cb => {
    cb.checked = source.checked;
  });
}

function deleteSelected() {
  const selected = Array.from(
    document.querySelectorAll(".rowCheck:checked")
  ).map(cb => Number(cb.value));

  if (selected.length === 0) {
    alert("Select at least one record");
    return;
  }

  if (!confirm("Delete selected records?")) return;

fetch("/admin/delete-selected", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({ indexes: selected })
})
.then(() => location.reload());

}

function deleteAll() {
  if (!confirm("âš ï¸ This will delete ALL records")) return;

  fetch("/admin/delete-all", {
  method: "POST"
})
.then(() => location.reload());


}
</script>


<hr class="my-4">

<h4 class="text-white mb-3">ğŸ‹ï¸ Homepage Images Control</h4>

<div class="row g-4">

  <!-- Athlete of the Month -->
  <div class="col-md-4">
    <div class="card bg-black text-light p-3">
      <h6>Athlete of the Month</h6>
     <img id="athleteImg" src="" class="w-100" alt="Best Physique">

      <input type="file" class="form-control"
  onchange="uploadImage(event, 'athlete')">

    </div>
  </div>

  <!-- Extra Image 1 -->
  <div class="col-md-4">
    <div class="card bg-black text-light p-3">
      <h6>Highlight Image 1</h6>
      <img id="galleryImg1" src="" class="w-100" alt="Best Physique1">

     <input type="file" class="form-control"
  onchange="uploadImage(event, 'img1')">

    </div>
  </div>

  <!-- Extra Image 2 -->
  <div class="col-md-4">
    <div class="card bg-black text-light p-3">
      <h6>Highlight Image 2</h6>
      <img id="galleryImg2" src="" class="w-100" alt="Best Physique2">

      <input type="file" class="form-control"
  onchange="uploadImage(event, 'img2')">

    </div>
  </div>

  <!-- Extra Image 3 -->
  <div class="col-md-4">
    <div class="card bg-black text-light p-3">
      <h6>Highlight Image 3</h6>
     <img id="galleryImg3" src="" class="w-100" alt="Best Physique3">

      <input type="file" class="form-control"
  onchange="uploadImage(event, 'img3')">

    </div>
  </div>

</div>

<script>
function previewImage(event, previewId) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function () {
    const img = document.getElementById(previewId);
    img.src = reader.result;
    img.style.display = "block";
  };
  reader.readAsDataURL(file);
}
</script>

<script>
function uploadImage(event, type) {
  const file = event.target.files[0];
  if (!file) return;

  const formData = new FormData();
  formData.append("image", file);
  formData.append("type", type);

  fetch("/admin/upload-image", {
    method: "POST",
    body: formData
  })
  .then(res => res.json())
  .then(data => {
    alert("Image saved successfully");
  })
  .catch(err => {
    alert("Upload failed");
  });
}
</script>

<script>
fetch("http://localhost:5000/homepage-images")
  .then(res => res.json())
  .then(data => {
    const base = "http://localhost:5000";

    // Hero image
    if (data.athlete) {
      document.getElementById("athleteImg").src = base + data.athlete;
    }

    // Gallery images
    if (data.img1) {
      document.getElementById("galleryImg1").src = base + data.img1;
    }

    if (data.img2) {
      document.getElementById("galleryImg2").src = base + data.img2;
    }

    if (data.img3) {
      document.getElementById("galleryImg3").src = base + data.img3;
    }
  })
  .catch(err => console.error("Image load error:", err));
</script>



<hr class="my-4">
<h4>âœï¸ Homepage Text Control</h4>

<div class="card bg-black p-3 mb-3">
  <h6>Athlete of the Month</h6>

<!-- Athlete -->
<input class="form-control cms-input" name="athleteName" placeholder="Athlete Name">
<input class="form-control cms-input" name="athleteSubtitle" placeholder="Natural Transformation Â· 8 Months">
<input class="form-control cms-input" name="athleteBadge" placeholder="-14 kg Fat Â· +7 kg Muscle">

<!-- Gallery 1 -->
<input class="form-control cms-input" name="g1name" placeholder="Gallery 1 Name">
<input class="form-control cms-input" name="g1desc" placeholder="Gallery 1 Description">
<input class="form-control cms-input" name="g1tag" placeholder="Gallery 1 Tag">

<!-- Gallery 2 -->
<input class="form-control cms-input" name="g2name" placeholder="Gallery 2 Name">
<input class="form-control cms-input" name="g2desc" placeholder="Gallery 2 Description">
<input class="form-control cms-input" name="g2tag" placeholder="Gallery 2 Tag">

<!-- Gallery 3 -->
<input class="form-control cms-input" name="g3name" placeholder="Gallery 3 Name">
<input class="form-control cms-input" name="g3desc" placeholder="Gallery 3 Description">
<input class="form-control cms-input" name="g3tag" placeholder="Gallery 3 Tag">



  <button class="btn btn-success w-100" onclick="saveText()">
  Save Text
</button>

</div>

<hr class="my-4">
<h4>ğŸ’° Membership Pricing Control</h4>

<div class="card bg-black p-3 mb-3">
  <input class="form-control cms-price mb-2" name="monthly" placeholder="Monthly Price (â‚¹)">
  <input class="form-control cms-price mb-2" name="quarterly" placeholder="3 Months Price (â‚¹)">
  <input class="form-control cms-price mb-3" name="yearly" placeholder="Yearly Price (â‚¹)">

  <button class="btn btn-success w-100" onclick="savePrices()">
    Save Prices
  </button>
</div>



<script>
function savePrices() {
  const data = {};

  document.querySelectorAll(".cms-price").forEach(input => {
    data[input.name] = input.value.trim();
  });

  console.log("ğŸ“¤ Sending prices:", data);

  fetch("/admin/save-prices", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(data)
  })
  .then(res => {
    if (!res.ok) throw new Error("Save failed");
    return res.json();
  })
  .then(() => {
    alert("âœ… Prices updated successfully");
  })
  .catch(err => {
    console.error(err);
    alert("âŒ Price save failed");
  });
}
</script>






<script>
function saveText() {
  const data = {};

  document.querySelectorAll(".cms-input").forEach(input => {
    data[input.name] = input.value;
  });

  fetch("/admin/save-text", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(() => {
    alert("Text saved successfully");
  })
  .catch(() => {
    alert("Save failed");
  });
}
</script>


<script>
function exportExcel() {
  window.location.href = "/admin/export-excel";
}
</script>



</body>
</html>

